version: 3
tasks:
  build:
    desc: "Build"
    cmds:
      - cargo build

  install:
    desc: "Install"

    deps:
      - build
    cmds:
      - install target/debug/wlout ~/.local/bin

  video:
    cmds:
      - ffmpeg -i wlout.mp4 -vf "fps=12,scale=800:-1:flags=lanczos,palettegen" palette.png
      - ffmpeg -i wlout.mp4 -i palette.png -lavfi "fps=12,scale=800:-1:flags=lanczos[x]; [x][1:v] paletteuse=dither=sierra2_4a" -loop 0 video.gif
